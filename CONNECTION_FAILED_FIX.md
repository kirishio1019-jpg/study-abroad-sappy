# 🔧 Connection Failed エラーの解決方法

## エラーの原因

「connection failed」というエラーが表示される場合、以下のいずれかが原因です：

1. **開発サーバーが起動していない**
2. **Supabaseの環境変数が設定されていない**

---

## ✅ 解決方法

### ステップ1: 開発サーバーが起動しているか確認

#### 確認方法

1. **Cursorの下部（ターミナル）を確認**
   - `Ctrl + Shift + ` を押してターミナルを開く
   - ターミナルに以下のようなメッセージが表示されているか確認：
     ```
     ✓ Ready in X seconds
     ○ Local:        http://localhost:3000
     ```

2. **このメッセージが表示されていない場合 → 開発サーバーを起動する必要があります**

#### 開発サーバーの起動方法

1. **Cursorでターミナルを開く**
   - `Ctrl + Shift + ` を押す
   - または、メニューから「ターミナル」→「新しいターミナル」

2. **ターミナルに以下のコマンドを貼り付けて実行：**
   ```powershell
   cd C:\Users\kiris\.cursor\study-abroad-comparison
   ```

3. **Enterキーを押す**

4. **次に、以下のコマンドを貼り付けて実行：**
   ```powershell
   npm run dev
   ```

5. **Enterキーを押す**

6. **以下のようなメッセージが表示されるまで待つ（30秒〜1分）：**
   ```
   ✓ Ready in X seconds
   ○ Local:        http://localhost:3000
   ```

7. **このメッセージが表示されたら、開発サーバーは起動しています**

---

### ステップ2: ブラウザで確認

1. **ブラウザを開く**

2. **アドレスバーに以下を入力：**
   ```
   http://localhost:3000
   ```

3. **Enterキーを押す**

4. **ページが表示されれば、接続成功です！**

---

### ステップ3: Supabaseの環境変数を設定する（必要に応じて）

もし、ページは表示されるがSupabase関連の機能（ログインなど）でエラーが出る場合：

1. **`.env.local`ファイルを作成する**

   - `study-abroad-comparison`フォルダの中に、`.env.local`というファイルを作成
   - このファイルに、以下の内容を貼り付ける：

   ```env
   NEXT_PUBLIC_SUPABASE_URL=あなたのSupabaseのURL
   NEXT_PUBLIC_SUPABASE_ANON_KEY=あなたのSupabaseのAnon Key
   ```

2. **Supabaseの認証情報を取得する方法**

   - `SUPABASE_SETUP_GUIDE.md`ファイルを参照してください
   - または、以下の手順：
     1. [Supabase](https://supabase.com/)にログイン
     2. プロジェクトを選択
     3. 左サイドバーから「⚙️ Settings」→「API」をクリック
     4. 「Project URL」と「anon public」キーをコピー
     5. `.env.local`ファイルに貼り付ける

3. **開発サーバーを再起動する**

   - 環境変数を変更したら、必ず開発サーバーを再起動する必要があります
   
   方法：
   - ターミナルで `Ctrl + C` を押してサーバーを停止
   - もう一度 `npm run dev` を実行

---

## 🔍 トラブルシューティング

### Q: 「npm が見つかりません」というエラーが出ます

A: Node.jsがインストールされていない可能性があります。
- Node.jsをインストールする必要があります
- [Node.js公式サイト](https://nodejs.org/)からダウンロード

### Q: 「Port 3000 is already in use」というエラーが出ます

A: 既にポート3000が使用されています。

解決方法：
1. 別のポートを使用する：
   ```powershell
   npm run dev -- -p 3001
   ```
   その後、`http://localhost:3001` でアクセス

2. または、ポート3000を使用しているプロセスを終了する

### Q: 開発サーバーは起動しているが、ブラウザで「接続できません」と表示される

A: 以下を確認してください：

1. **ブラウザのアドレスバーに正しいURLが入力されているか確認**
   - `http://localhost:3000` （http://から始まる）
   - `localhost` のスペルが正しいか
   - ポート番号が `3000` になっているか

2. **開発サーバーのターミナルでエラーメッセージを確認**
   - ターミナルに赤いエラーメッセージが表示されていないか確認

3. **ファイアウォールがブロックしている可能性**
   - Windowsファイアウォールの設定を確認

### Q: ターミナルにエラーメッセージが表示される

A: エラーメッセージの内容を確認してください。

よくあるエラー：

1. **「Cannot find module」**
   - 依存関係がインストールされていない
   - 解決方法：
     ```powershell
     npm install
     ```

2. **「EADDRINUSE」**
   - ポートが既に使用されている
   - 解決方法：別のポートを使用する（上記参照）

---

## 📋 確認チェックリスト

接続エラーを解決するために、以下を確認してください：

- [ ] 開発サーバーが起動している（ターミナルに「✓ Ready」が表示されている）
- [ ] ブラウザのアドレスバーに `http://localhost:3000` が入力されている
- [ ] `.env.local`ファイルが存在する（Supabase機能を使う場合）
- [ ] 環境変数が正しく設定されている（Supabase機能を使う場合）
- [ ] 開発サーバーを再起動した（環境変数を変更した場合）

---

## 💡 まだ解決しない場合

以下の情報を確認してください：

1. **どのページで「connection failed」が表示されますか？**
   - トップページ？
   - ログインページ？
   - その他のページ？

2. **ブラウザの開発者ツールでエラーを確認**
   - `F12`キーを押して開発者ツールを開く
   - 「Console」タブをクリック
   - 赤いエラーメッセージが表示されているか確認
   - そのエラーメッセージを教えてください

3. **ターミナルにエラーメッセージが表示されているか**
   - ターミナルに赤いエラーメッセージが表示されているか確認
   - そのエラーメッセージを教えてください

これらの情報があれば、より具体的に解決できます！

